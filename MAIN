-- LOADING

local Client;

repeat 

wait() until game.IsLoaded

repeat

wait() until game:GetService("Players").LocalPlayer; 

Client = game:GetService("Players").LocalPlayer

-- SYNAPSE CHECK

local Synapse, Error = pcall(function()
   if not syn then

      Client:Kick("\n\nRequires SYNAPSE X")

      return
   end
end)

if not Synapse then 
   
   Client:Kick("\n\nRequires SYNAPSE X")

   return
end

-- SERVICES

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")

-- SETTINGS FUNCTIONS

local Settings_File = "INF_SETTINGS.JSON"

_G.Settings = { }
_G.INFGUIS = { }

_G.SaveSettings = function()
   writefile(Settings_File, HttpService:JSONEncode(_G.Settings))
end

_G.GetSettings = function(Str)
   if _G.Settings[Str] ~= nil then

       return true
   else
 
       return false
   end
end

_G.TestWebhook = function()
   syn.request({
      Url = _G.Settings["WEBHOOK_VALUE"],
      Method = "POST",
      Headers = {
       ["Content-Type"] = "application/json"
      },
      Body = HttpService:JSONEncode({content = "@everyone this is now your enchant webhook!"})
   })     
end

-- SETTINGS 

local Default_Settings = {
 ["ACCESSORY"] = true,
 ["WEAPON"] = true,
 ["HISTORY"] = false,
 ["WEBHOOK"] = false,
 ["WEBHOOK_VALUE"] = ""
}

if not isfile(Settings_File) then

   writefile(Settings_File, HttpService:JSONEncode(Default_Settings));

   _G.Settings = Default_Settings

elseif isfile(Settings_File) then

   local File_Content = readfile(Settings_File)
   local File_Content_Decoded = HttpService:JSONDecode(File_Content)

   _G.Settings = File_Content_Decoded
end

-- OTHER

local Load = function(Str, Name)
   
   local Success, Error = pcall(function()
       loadstring(Str)()
   end)			

   if not Success then
     
      Client:Kick("\n\nVITAL ERROR [ " .. Name .. " ]\n\nERROR: " .. Error)

      return  
   else

      return "OK"
   end
end

local GET = function(Str)
   
   local Success, Return = pcall(game.HttpGet, game, Str)

   if not Success then
      
      Client:Kick("\n\nGET ERROR")

      return
   else
 
      return Return
   end
end

-- GET 

local UI = GET("https://raw.githubusercontent.com/R00T66/INF/main/UI")
local SCRIPT = GET("https://raw.githubusercontent.com/R00T66/INF/main/SCRIPT")

-- LOADING

local UI_RETURN = Load(UI, "UI")
local SCRIPT_RETURN = Load(SCRIPT, "SCRIPT")

if UI_RETURN ~= "OK" or SCRIPT_RETURN ~= "OK" then

   Client:Kick("\n\nUNKNOWN ERROR?")

   return
end
